@import "tailwindcss";
@import "tw-animate-css";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-stitch-sans);
  --font-mono: var(--font-stitch-mono);
  /* Sidebar & Chart Variables Preserved */
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);
}

:root {
  --radius: 0.75rem;

  --background: var(--stitch-background, #080a0f);
  --foreground: var(--stitch-text-primary, #e1e1e1);

  --card: color-mix(in oklab, var(--stitch-surface, #16181d) 92%, #ffffff 8%);
  --card-foreground: var(--stitch-text-primary, #e1e1e1);

  --popover: color-mix(in oklab, var(--stitch-surface, #16181d) 94%, #000000 6%);
  --popover-foreground: var(--stitch-text-primary, #e1e1e1);

  --primary: var(--stitch-accent, #7c3bed);
  --primary-foreground: #ffffff;

  --secondary: color-mix(in oklab, var(--stitch-surface, #16181d) 88%, #ffffff 12%);
  --secondary-foreground: var(--stitch-text-primary, #e1e1e1);

  --muted: color-mix(in oklab, var(--stitch-surface, #16181d) 84%, #ffffff 16%);
  --muted-foreground: var(--stitch-text-secondary, #8a8d91);

  --accent: color-mix(in oklab, var(--stitch-accent, #7c3bed) 20%, transparent);
  --accent-foreground: #ffffff;

  --destructive: #c53030;
  --destructive-foreground: #ffffff;

  --border: var(--stitch-border, #24282d);
  --input: var(--stitch-border, #24282d);
  --ring: var(--stitch-accent, #7c3bed);
}

.dark {
  --background: var(--stitch-background, #080a0f);
  --foreground: var(--stitch-text-primary, #e1e1e1);
}


@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  :focus-visible {
    outline: 2px solid rgba(255, 255, 255, 0.7);
    outline-offset: 2px;
  }
  body {
    @apply bg-background text-foreground antialiased;
    font-family: var(--stitch-font-sans, var(--font-stitch-sans), sans-serif);
    background:
      radial-gradient(55% 35% at 50% -10%, color-mix(in oklab, var(--stitch-accent, #7c3bed) 30%, transparent), transparent 68%),
      radial-gradient(40% 30% at 8% 20%, rgba(14, 165, 233, 0.15), transparent 70%),
      radial-gradient(34% 26% at 92% 16%, rgba(34, 197, 94, 0.1), transparent 76%),
      var(--stitch-background, #080a0f);
    background-image:
      radial-gradient(55% 35% at 50% -10%, color-mix(in oklab, var(--stitch-accent, #7c3bed) 30%, transparent), transparent 68%),
      radial-gradient(40% 30% at 8% 20%, rgba(14, 165, 233, 0.15), transparent 70%),
      radial-gradient(34% 26% at 92% 16%, rgba(34, 197, 94, 0.1), transparent 76%),
      var(--stitch-background, #080a0f),
      url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.72' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.025'/%3E%3C/svg%3E");
    background-attachment: fixed;
  }
  
  body::after {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    background: radial-gradient(circle at 20% 80%, rgba(255, 255, 255, 0.04), transparent 55%);
    z-index: 1;
    mix-blend-mode: soft-light;
  }
}

@media (max-width: 768px) {
  input,
  textarea,
  select,
  button {
    font-size: 16px;
  }
}

@layer utilities {
  .text-glow {
    text-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
  }

  .custom-scrollbar {
    scrollbar-width: thin;
    scrollbar-color: color-mix(in oklab, var(--stitch-accent, #7c3bed) 45%, #2a2d35) transparent;
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .custom-scrollbar::-webkit-scrollbar-thumb {
    border-radius: 999px;
    border: 2px solid transparent;
    background-clip: padding-box;
    background: color-mix(in oklab, var(--stitch-accent, #7c3bed) 45%, #2a2d35);
  }

  @keyframes spin-slow {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  .animate-spin-slow {
    animation: spin-slow 8s linear infinite;
  }
  
  /* Matches StrategyOS "Liquid Glass" for better legibility */
  .liquid-glass {
    @apply bg-white/5 backdrop-blur-3xl border border-white/10 shadow-[0_8px_32px_0_rgba(0,0,0,0.5)];
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.05);
  }

  .liquid-panel {
    background: rgba( 20, 20, 20, 0.6 ); /* Darker, more solid for better contrast */
    box-shadow: 0 8px 32px 0 rgba( 0, 0, 0, 0.5 );
    backdrop-filter: blur( 40px );
    -webkit-backdrop-filter: blur( 40px );
    border-radius: 24px;
    border: 1px solid rgba( 255, 255, 255, 0.08 );
  }

  .glass-panel {
    /* Updated to be slightly more legible than the previous mostly-transparent version */
    background: rgba( 10, 10, 10, 0.7 ); 
    box-shadow: 0 8px 32px 0 rgba( 0, 0, 0, 0.5 );
    backdrop-filter: blur( 40px );
    -webkit-backdrop-filter: blur( 40px );
    border-radius: 20px;
    border: 1px solid rgba( 255, 255, 255, 0.08 );
  }

  @keyframes shimmer {
    0% { transform: translateX(-100%); }
    100% { transform: translateX(300%); }
  }

  .animate-shimmer {
    animation: shimmer 2s infinite linear;
  }

  @keyframes flash-green {
    0% { background-color: rgba(34, 197, 94, 0.4); box-shadow: 0 0 20px rgba(34, 197, 94, 0.5); border-color: rgba(34, 197, 94, 0.8); }
    100% { background-color: rgba(34, 197, 94, 0.05); box-shadow: none; border-color: rgba(34, 197, 94, 0.1); }
  }

  .highlight-flash {
    animation: flash-green 1s ease-out forwards;
  }
  
  /* Strategy Design System - Preserved & Integrated */
  .strategy-card {
    @apply relative overflow-hidden rounded-2xl border border-white/10 shadow-2xl;
    background: rgba(20, 20, 20, 0.6);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
    box-shadow: 
      0 0 0 1px rgba(255, 255, 255, 0.08),
      0 20px 40px -12px rgba(0, 0, 0, 0.5);
  }

  /* Inner light gradient for strategy card */
  .strategy-card::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(
      800px circle at top center, 
      rgba(120, 50, 255, 0.08), 
      transparent 40%
    );
    pointer-events: none;
  }

  .btn-primary {
    @apply relative flex items-center justify-center gap-2 px-8 py-3 rounded-xl font-medium transition-all duration-300;
    background: linear-gradient(135deg, #7c3aed 0%, #6d28d9 100%);
    color: white;
    text-shadow: 0 1px 2px rgba(0,0,0,0.2);
    box-shadow: 
      0 0 0 1px rgba(139, 92, 246, 0.5),
      0 4px 12px rgba(124, 58, 237, 0.3),
      inset 0 1px 1px rgba(255,255,255,0.2);
  }

  .btn-primary:hover {
    transform: translateY(-1px);
    box-shadow: 
      0 0 0 1px rgba(167, 139, 250, 0.6),
      0 8px 24px rgba(124, 58, 237, 0.5),
      inset 0 1px 1px rgba(255,255,255,0.3);
  }

  .btn-primary:active {
    transform: translateY(1px);
    box-shadow: 
      0 0 0 1px rgba(139, 92, 246, 0.4),
      0 2px 4px rgba(124, 58, 237, 0.2),
      inset 0 1px 2px rgba(0,0,0,0.2);
  }
}

/* --- Mission Control Glassmorphism & Animations (Phase 28) --- */
@layer utilities {
  .glass {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .glass-darker {
    background: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.05);
  }

  .nebula-bg {
    background: radial-gradient(circle at 20% 30%, rgba(13, 89, 242, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 80% 70%, rgba(147, 51, 234, 0.1) 0%, transparent 40%),
                #080a0f;
  }

  .status-pulse-container {
    position: relative;
    display: inline-block;
    width: 8px;
    height: 8px;
    border-radius: 50%;
  }

  .status-pulse-container::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    animation: mission-pulse-ring 1.5s cubic-bezier(0.215, 0.61, 0.355, 1) infinite;
  }

  @keyframes mission-pulse-ring {
    0% { transform: scale(.33); }
    80%, 100% { opacity: 0; }
  }

  @keyframes pulse-soft {
    0%, 100% { transform: scale(1); opacity: 0.5; }
    50% { transform: scale(1.1); opacity: 0.8; }
  }

  @keyframes pulse-vibrant {
    0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.7); }
    70% { transform: scale(1.05); box-shadow: 0 0 0 20px rgba(16, 185, 129, 0); }
    100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(16, 185, 129, 0); }
  }

  @keyframes pulse-error {
    0% { transform: scale(1) translateX(0); box-shadow: 0 0 0 0 rgba(225, 29, 72, 0.8); }
    10% { transform: scale(1.1) translateX(-1px); }
    20% { transform: scale(1.1) translateX(1px); }
    30% { transform: scale(1.1) translateX(0); box-shadow: 0 0 40px 10px rgba(225, 29, 72, 0); }
    100% { transform: scale(1) translateX(0); }
  }

  .animate-pulse-soft { animation: pulse-soft 3s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
  .animate-pulse-vibrant { animation: pulse-vibrant 2s cubic-bezier(0.4, 0, 0.2, 1) infinite; }
  .animate-pulse-error { animation: pulse-error 0.8s cubic-bezier(0.36, 0.07, 0.19, 0.97) infinite; }

  .pulse-active::after { background-color: #0bda5b; }
  .pulse-busy::after { background-color: #fa6238; }
  .pulse-idle::after { background-color: #facc15; }
  .pulse-primary::after { background-color: #137fec; }

  .status-glow-green { box-shadow: 0 0 8px #10b981; }
  .status-glow-amber { box-shadow: 0 0 8px #f59e0b; }
  .status-glow-red { box-shadow: 0 0 8px #ef4444; }
  .status-glow-blue { box-shadow: 0 0 8px #0d59f2; }

  /* World Class Glows */
  .glow-cyan {
    filter: drop-shadow(0 0 8px rgba(34, 211, 238, 0.4));
  }
  .glow-white {
    filter: drop-shadow(0 0 10px rgba(255, 255, 255, 0.2));
  }
  .glow-text-cyan {
    text-shadow: 0 0 12px rgba(34, 211, 238, 0.6);
  }
  
  .glass-morphism {
    background: rgba(15, 15, 20, 0.7);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border: 1px solid rgba(255, 255, 255, 0.08);
  }
}

/* PWA MOBILE OPTIMIZATIONS */
@layer base {
  html, body {
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
  }

  button, a {
    user-select: none;
  }

  button:active {
    transform: scale(0.96);
    transition: transform 0.1s ease;
  }
}
